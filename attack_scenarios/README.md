# Attack Scenarios

---
## Attack Proposol
- 공격자는 악성 코드를 주입하여 **차량의 사고를 유발하고나 제어 권한을 얻는 것**을 목표로 함
- 공격자는 정식 OTA를 방해하여 **차량이 보안 혹은 기능적으로 취약한 상태를 유지하는 것**을 목표로 함

  
## 1. Supply Chain Attack

### 공격 시나리오 1: 정식 OTA 파일 업로드 웹페이지를 통해 악성 코드 업데이트 [Level 1]

#### 공격 시나리오 전제 조건
파일을 업로드하는 웹사이트의 URL IP 주소값(혹은 도메인)을 공격자가 획득한 것으로 가정한다.

#### 공격 시나리오 수행 방법
1. 공격자는 타겟 ECU에 주입할 악성 펌웨어/소프트웨어에 해당하는 .bin 파일을 생성한다.
2. OTA 파일을 업로드하는 정식 웹사이트를 통해 .bin 파일을 업로드한다.
3. 인증이 없는 차량은 해당 악성 파일을 설치한다.
---

### 공격 시나리오 2: MQTT broker에 악성 코드 혹은 URL publishing [Level 1]

#### 공격 시나리오 전제 조건
인증된 차량 해킹 하여 OEM에서 활용 중인 MQTT Broker의 IP를 획득한 것으로 가정한다.

#### 공격 시나리오 수행 방법
1. MQTT broker에 악성 파일 혹은 펌웨어/소프트웨어 다운로드 URL을 publish 한다.
2. Broker는 해당 정보를 topic이 일치하는 차량 전체에 방송한다.
3. 인증이 없는 차량은 해당 악성 파일을 설치한다.
---

## 2. Man-in-the-middle Attack

### 공격 시나리오 1: OTA 웹페이지를 캡처하여 파일 유출 및 변조

#### 공격 시나리오 전제 조건
해킹을 통해 관리자가 펌웨어를 업로드 하기 위해 사용하는 컴퓨터(장비)의 지정 프록시 서버를를 공격자의 프록시 서버로 변경한 것으로 가정한다.

#### 공격 시나리오 수행 방법
1. 업데이트를 파일 업로드를 수행할 컴퓨터의 프록시 서버 IP 주소를 공격자의 IP 주소로 할당한다. 
2. burf 등의 툴을 이용하여 Web에서 파일 업로드를 수행할 때 서버로 전송되는 패킷을 캡처한다.
3. 캡처된 패킷에서 암호화 되지 않은 파일 내용을 변조하여 전송한다.
4. 인증이 없는 차량은 해당 악성 파일을 설치한다.
---

### 공격 시나리오 2: 서버 IP 주소 요청의 응답을 변조하여 가짜 서버 연결 

#### 공격 시나리오 전제 조건
해킹을 통해 프록시 서버 혹은 DNS 서버를 장악하여 IP 주소에 대한 리스폰스를 변조할 수 있다고 가정한다.

#### 공격 시나리오 수행 방법
1. 공격자가 리스폰스된 IP 주소를 위조하였다고 가정하고 차량에 해당하는 직접 Client를 가짜 MQTT 브로커 혹은 OTA 서버에 연결한다.
2. 공격자는 차량의 연결 및 업데이트 요청이 확인되면 해당 차량 OTA 포멧에 맞게 악성 코드 패킷을 생성한다.
3. 생성된 악성 패킷을 차량으로 전송한다.
4. 인증이 없는 차량은 해당 악성 파일을 설치한다.

---
### 공격 시나리오 3: 차량으로 전송되는 업데이트 패킷 변조

#### 공격 시나리오 전제 조건
해킹을 통해 무선 통신을 중계하는 라우터를 장악하여 IP 주소에 대한 리스폰스를 변조할 수 있다고 가정한다.

#### 공격 시나리오 수행 방법
1. 업데이트 파일을 정상 OTA 경로를 통해 업로드 한다.
2. 업데이트 패킷을 차량으로 전송 중 라우터에 의해 강제로 공격자의 IP로 패킷이 경유하게 한것으로 가정하고 공격자 IP로 파일 전송
3. 공격자의 IP를 업데이트 서버로 위장한 것으로 가정하고 차량에 변조된 패킷을 전송한다.
4. 인증이 없는 차량은 해당 악성 파일을 설치한다.

## 3. Replay Attack

### 공격 시나리오: 과거 업데이트 패킷 재사용

#### 공격 시나리오 전제 조건
가짜 MQTT broker에 차량이 연결하도록 하여 공격자가 원하는 시점에 업데이트를 시도할 수 있다고 가정한다.

#### 공격 시나리오 수행 방법
1. 정상 업데이트에 전송되는 패킷을 다른 OTA 타겟을 통해 캡처 및 보관한다.
2. 과거 버전에 취약점이 새로운 버전에 의해 보완된 것으로 가정하고 과거 버전의 파일의 업데이트를 가짜 MQTT broker를 통해 시도한다.
3. 차량은 메시지 신선도 검증 미흡으로 해당 패킷 설치한다.
---
